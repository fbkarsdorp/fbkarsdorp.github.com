<!doctype html>

<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="description" content="Academic website of Folgert Karsdorp">
        <meta name="viewport" content="width=device-width, initial-scale=1.0,
                    minimum-scale=1.0">
        <title>Folgert Karsdorp</title>
        <meta name="title" content="Folgert Karsdorp">

        <!-- Open Graph / Facebook -->
        <meta property="og:type" content="website">
        <meta property="og:url" content="https://www.karsdorp.io/">
        <meta property="og:title" content="Folgert Karsdorp">
        <meta property="og:description" content="Academic website of Folgert Karsdorp">
        <meta property="og:image" content="https://www.karsdorp.io/static/images/preview.png">

        <!-- Twitter -->
        <meta property="twitter:card" content="summary_large_image">
        <meta property="twitter:url" content="https://www.karsdorp.io/">
        <meta property="twitter:title" content="Folgert Karsdorp">
        <meta property="twitter:description" content="Academic website of Folgert Karsdorp">
        <meta property="twitter:image" content="https://www.karsdorp.io/static/images/preview.png">

        <link rel="stylesheet" href="/css/main.css" />
        <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/pcooksey/bibtex-js@1.0.0/src/bibtex_js.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js" type="text/javascript"></script>
        <bibtex src="./static/references.bib"></bibtex>

        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </head>

    <script>
    MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  },
  svg: {
    fontCache: 'global'
  }
    };
      </script>

    
    <body>
        <div class="wrapper">
            <div class="content">
                <div class="nav-container">
    <header>
        <div class="author-info">
            <div class="name"><a href="/">Folgert Karsdorp</a></div>
        </div>
        <nav>
            <ul>
                <li><a href="https://twitter.com/FolgertK" target="_blank">Twitter</a></li>
                <li><a href="https://github.com/fbkarsdorp" target="_blank">Github</a></li>
                <li><a href="mailto:folgert.karsdorp@meertens.knaw.nl">E-mail</a></li>
            </ul>
        </nav>
    </header>
</div>
                <h2>Demystifying Chao1 with Good-Turing</h2>
                <p>To estimate the &quot;biodiversity&quot; in a particular area – or, in other
words, the number of unique species living in a given environment –
ecologists usually have no other option than to rely on incomplete
samples. For all sorts of practical reasons, it is virtually impossible
to spot all species that are actually present in an area, and hence
certain species will be missing in the counts. Consequently, an
important research question in ecology is how to reliably estimate the
resulting &quot;bias&quot; between the number of species that was observerd and
the true number of unique species in an area.</p>
<p>Of course, scientists are not only confronted with the possibility of
'unseen entities' when counting animal species. In astronomy, too, for
example, researchers are interested in counting the number of unseen
stars. In linguistics, researchers have also attempted to estimate the
total size of a language's vocabulary using only samples of that
language. And in computer science, researchers have tried to estimate
the number of undetected &quot;bugs&quot; in software code. In all these
applications, the same problem arsises: there are more unique stars,
words, or bugs than we observe in our samples, and therefore we cannot
base our judgement about the diversity of the phenomenon we are
investigating directly on our observed counts. That would give a biased
– or worse, an impoverished – picture of the true state of affairs.
Hence, the statistical methods that have been developed in ecology to
combat such biases are very useful in a wide variety of domains.</p>
<p>In the cultural domain, too, there have been attempts to correct biases
in our observations with statistical methods. A good example is our
study into the loss of European medieval literature (Kestemont, 2022),
which was recently published in
the journal <em>Science</em>. In that study, we apply a specific &quot;Unseen
Species&quot; model to medieval stories. Medieval stories (such as the
legends about &quot;King Arthur&quot; or the stories surrounding the emperor
Charlemagne) were often recorded several times in manuscripts. But not
all of these copies or manuscripts have been preserved – and, therefore
it is possible that the stories they contained have not been preserved
either. Our aim, then, was to use an &quot;Unseen Species&quot; model to estimate
how many &quot;documents&quot; (the manuscripts) and how many &quot;works&quot; (the
stories) and been lost. The model we used is called the &quot;Chao1
estimator&quot;, named after its discoverer, Anne Chao, co-author of our
study.</p>
<p>We are often asked how Chao1 can make these estimates of unseen things. But that question
is not so easy to answer, because the exact motivation and derivation of Chao1 is not
particularly intuitive (neither for ecologists, nor for cultural scholars). But
fortunately, as Chao et al. 2017 have shown, Chao1 can also be derived in a slightly
different and much more intuitive way. This derivation is based on the groundbreaking work
of the famous computer scientist Alan Turing, which he did at Bletchley Park during World
War II. Below, guided by Chao et al. 2017, I will try to demystify Chao1 in terms of
Turing's work. I hope that this will help people unfamiliar with the method to understand
exactly how it works, and, perhaps more importantly, how (not) to interpret the calculated
values.</p>
<p>Imagine that we discovered a snippet from an unknown book. The snippet
has a total of 18 words on it, consisting of 6 unique words with the
following frequencies:</p>
<table>
<thead>
<tr>
<th>word</th>
<th>frequency</th>
</tr>
</thead>
<tbody>
<tr>
<td>the</td>
<td>10</td>
</tr>
<tr>
<td>for</td>
<td>3</td>
</tr>
<tr>
<td>woman</td>
<td>2</td>
</tr>
<tr>
<td>park</td>
<td>1</td>
</tr>
<tr>
<td>snake</td>
<td>1</td>
</tr>
<tr>
<td>book</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>The total number of words as well as the number of unique words in this
scenario are of importance. Based on this snippet, where the total
frequency <em>n</em> is 18, we would like to estimate how many unique words
there were in the original, unaffected book. The snippet thus provides
us with a &quot;sample&quot; or a subset of the vocabulary in the original work.
The complete vocabulary can be indicated by the symbol <em>V</em>, and the
observed vocabulary in the snippet is then called <em>V</em><sub>obs</sub>. The
aim of unseen species models, such as Chao1, is then to estimate the
true number of unique words <em>V</em> on the basis of the observed unique
vocabulary items (<em>V</em><sub>obs</sub>) and their frequencies. To this end,
we need to know about how many words have a frequency of 0 in our
snippet – or, in other words, how many unique words are missing from our
sample. If we refer to that number as <em>f</em><sub>0</sub>, we can calculate
the total number of words <em>V</em> by adding <em>f</em><sub>0</sub> to the number of
unique observed words <em>V</em><sub>obs</sub>:</p>
<p><em>V</em> = <em>f</em><sub>0</sub> + <em>V</em><sub>obs</sub> = <em>f</em><sub>0</sub> + 6   (1)</p>
<p>The key question is, of course, how to calculate <em>f</em><sub>0</sub>. If we
assume that our snippet represents the complete work, it is easy to
calculate the probability of a word such as <em>book</em>. Let's illustrate
that with the word <em>book</em>: if the snippet represents the whole work, we
can simply divide the frequecy of <em>book</em> by the total number of words:
$\frac{1}{18} = 0.056$. Similarly, we can calculate the probability
that a word has a frequency <em>r</em>, for example <em>r</em> = 1 (words that occur
only once, i.e. singletons). There are 3 words in total with a frequency
of <em>r</em> = 1, which we write down as <em>f</em><sub>1</sub> = 3. The probability
that a word has a frequency of 1 is then equal to <em>f</em><sub>1</sub>
divided by the total number of words in a book:
$\frac{f_1}{n} = \frac{3}{18} = 0.167$. And the average relative
frequency of words with <em>r</em> = 1 is then equal to:
$\alpha_1 = \frac{1}{18} f_1 /
f_1 = \frac{1}{18}$. But of course the 18-word snippet is just a
snippet, and not a whole work. Because the snippet is not complete,
there is a considerable chance that we have not yet seen certain words
from the original, complete book. Therefore, in our probability
calculations, we must take into account the possibility that we will
come across a range of unseen words. But how?</p>
<p>Well, let's suppose that we find another snippet of the same manuscript
containing one new word. What is then the probability that this new word
is another instance of the already observed <em>book</em>? Note that if this
new word is indeed the word <em>book</em>, then <em>book</em> no longer occurs once
but twice. In other words, <em>book</em> then no longer has the frequency
<em>r</em> = 1 but <em>r</em> = 1 + 1. To account for such situations, Turing and his
student Good proposed not to estimate the probability of a word
occurring <em>r</em> times with $\frac{r}{n}$ but with an adjusted count
$\frac{r^*}{n}$ (note the asterisk). This modified count states that
the probability that we have seen a new words <em>r</em> + 1 times is equal to
the probability of the words we have already seen <em>r</em> + 1 times. This
can be formulated as:
<em>r</em><sup>*</sup> = (<em>r</em>+1)<em>f</em><sub><em>r</em> + 1</sub>/<em>f</em><sub><em>r</em></sub>. The
average relative frequency of words that occur <em>r</em> times can then be
computed with:</p>
<p>$$\begin{equation}
\alpha_r = \frac{r^*}{n} = \frac{(r + 1)}{n} \frac{f_{r + 1}}{f_r}.
\end{equation} \qquad (2)$$</p>
<p>To illustrate: the word <em>book</em> occurs once in the snippet and there are
two other words that occur once. This, as stated before, gives
<em>f</em><sub>1</sub> = 3. There is one word with a frequency of 2, so
<em>f</em><sub>2</sub> = 1. If we plug these number into the formula above, we
can calculate the probability that the new word is the word <em>book</em>:
$\frac{(1 + 1)}{18}
\frac{1}{3} = 0.037$. It is important to note that this new probability
is smaller than the relative frequency of <em>book</em> in the snippet that we
caculated earlier (1/18 = 0.056). This is because the Good-Turing counts
act as a kind of frequency correction, ensuring that we leave some
probability space for any unseen words – and hence the corrected
probability is smaller.</p>
<p>Before we continue with showing how to use this all for computing
<em>f</em><sub>0</sub>, it is important to make a small modification to the
original Good-Turing formula. In a follow-up study, Chiu et al. (2014) show that the
Good-Turing estimate can be made even more precise with:</p>
<p>$$\begin{equation}
\alpha_r = \frac{(r + 1) f_{r + 1}}{(n - r) f_r}.
\end{equation} \qquad (3)$$</p>
<p>For unseen words, we cannot calculate the average relative frequency
<em>α</em><sub>0</sub>, because we have no knowledge of <em>f</em><sub>0</sub>:
$\frac{f_1}{n f_0=?}$. What we <em>are</em> able to calculate, however, is the
estimated proportion of the total number of words that are unseen. That
proportion is equal to the product of the average relative frequency of
unseen words <em>α</em><sub>0</sub> and the number of unseen words
<em>f</em><sub>0</sub>: <em>α</em><sub>0</sub><em>f</em><sub>0</sub>. This product can be
approximated by dividing the number of words that occur once by the
total number of words: $\frac{f_1}{n}$. Essentialy, we strip
<em>f</em><sub>0</sub> from the formula.</p>
<p>We are now almost in the position to grasp how to estimate
<em>f</em><sub>0</sub>. As I mentioned, we can estimate the product
<em>α</em><sub>0</sub><em>f</em><sub>0</sub> with $\frac{f_1}{n}$. A simple way to
compute <em>f</em><sub>0</sub> would be to divide this product by
<em>α</em><sub>0</sub>. But unfortunately, we do not know the average relative
frequency of unseen words. We therefore have to work with what we do
know, for example that the average relative frequency of unseen words is
probably lower that that of words occuring once. That is to say:
<em>α</em><sub>0</sub> ≤ <em>α</em><sub>1</sub>. It then follows that
$\frac{\alpha_0 f_0}{\alpha_0}$ must be <em>at least</em> equal to or
greater than $\frac{\alpha_0 f_0}{\alpha_1}$:</p>
<p>$$\begin{equation}
f_0 = \frac{\alpha_0 f_0}{\alpha_0} \geq \frac{\alpha_0 f_0}{\alpha_1}.
\end{equation} \qquad (4)$$</p>
<p>We can rewrite that last formula ($\frac{\alpha_0 f_0}{\alpha_1}$) to
the calculable $\frac{f1}{n} / \frac{2f_2}{(n - 1)f_1}$. If we apply
this formula to our snippet, the estimate is that we have not yet seen
at least $\frac{3}{18} / \frac{2 * 1}{(18 - 1) * 3}
\approx 4$ words yet. It is important to emphasize again that
$\frac{\alpha_0
f_0}{\alpha_0}$ is <em>at least</em> equal to or greater than
$\frac{\alpha_0 f_0}{\alpha_1}$, and that our estimate of
<em>f</em><sub>0</sub> is thus a <em>lower bound</em> on the true number of unique
words. This estimate, based on Good-Turing counts, gives the same lower
bound for <em>f</em><sub>0</sub> that Anne Chao has proven extensively (Chao,
1984), and can be calculated with her well-known unseen species
model, Chao1, which can be formulated as:
$\frac{(n - 1)}{n} \frac{f_1^2}{2 f_2}$.</p>
<p>The Chao1 model thus provides a lower bound of the ecological, or
cultural, richness in a given area. Using the Good-Turing perspective,
we can now also clarify when the lower bound is in fact an accurate
estimate of the true richness. The reasoning is as follows: if the
average frequency of unseen words (<em>α</em><sub>0</sub>) is approximately
equal to that of words that occur once (<em>α</em><sub>1</sub>), then there is
no longer any difference between $\frac{\alpha_0 f_0}{\alpha_0}$ and
$\frac{\alpha_0 f_0}{\alpha_1}$, and thus the method can provide an
unbiased estimate of the number of unique species, or say, cultural
artefacts, such as medieval stories that exist in a given area –
including the ones that have not been seen.</p>
<h1>References</h1>
<p>Chao, Anne (1984). <em>Nonparametric Estimation of the Number of Classes in
a Population</em>, Scandinavian Journal of Statistics.</p>
<p>Chao, Anne and Chiu, Chun‐Huo and Colwell, Robert K. and Magnago, Luiz
Fernando S. and Chazdon, Robin L. and Gotelli, Nicholas J. (2017).
<em>Deciphering the Enigma of Undetected Species, Phylogenetic, and
Functional Diversity Based on Good‐Turing Theory</em>, Ecology.</p>
<p>Chiu, Chun-Huo and Wang, Yi-Ting and Walther, Bruno A. and Chao, Anne
(2014). <em>An Improved Nonparametric Lower Bound of Species Richness via a
Modified Good-Turing Frequency Formula: An Improved Nonparametric Lower
Bound of Species Richness</em>, Biometrics.</p>
<p>Kestemont, Mike and Karsdorp, Folgert and {de Bruijn}, Elisabeth and
Driscoll, Matthew and Kapitan, Katarzyna A. and Ó Macháin, Pádraig and
Sawyer, Daniel and Sleiderink, Remco and Chao, Anne (2022). <em>Forgotten
Books: The Application of Unseen Species Models to the Survival of
Culture</em>, Science.</p>

            </div>
        </div>
    </body>
</html>
