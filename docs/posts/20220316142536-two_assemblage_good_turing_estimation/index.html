<!DOCTYPE html>
<html lang="en-us">
<head>
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <script type="text/javascript" src="https://latest.cactus.chat/cactus.js"></script>
  <link rel="stylesheet" href="https://latest.cactus.chat/style.css" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> Estimating Unseen Shared Cultural Diversity | Folgert Karsdorp</title>
  <link rel = 'canonical' href = 'https://www.karsdorp.io/posts/20220316142536-two_assemblage_good_turing_estimation/'>
  <meta name="description" content="I&#39;m a researcher in Computational Humanities and Cultural Evolution at
  the [Meertens Institute](https://www.meertens.knaw.nl) of the Royal Netherlands Academy
  of Arts and Sciences (Amsterdam, the Netherlands).

  My research focuses on why some cultural phenomena are adopted and persist through time,
  while others change or disappear. Additionally, I&#39;m interested in measuring cultural
  diversity and compositional complexity, and how we can account for biases in our
  estimations of diversity. To do that, I use computational models from Machine Learning,
  Cultural Evolution, and Ecology.

  Besides cultural change and diversity, I&#39;m also interested in teaching about computer
  programming in the context of the Humanities. I published a text book with [Princeton
  University
  Press](https://press.princeton.edu/books/hardcover/9780691172361/humanities-data-analysis)
  about using Python for Humanities data analysis. Check out the open access edition
  [here](https://www.humanitiesdataanalysis.org)!">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="Estimating Unseen Shared Cultural Diversity" />
<meta property="og:description" content="Shared Species Estimation In Demystifying Chao1 with Good-Turing, I tried to explain the intuition behind the Chao1 estimator (Chao 1984) for unseen species using the Good-Turing estimator as described in Chao et al. (2017). The latter article discusses another set of diversity measures within that same framework of Turing. The number of unique species or the number of unique cultural artifacts in a given environment is only one diversity measure, but we can also study the shared diversity between two cultural collections, for example." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.karsdorp.io/posts/20220316142536-two_assemblage_good_turing_estimation/" /><meta property="article:section" content="posts" />

<meta property="article:modified_time" content="2022-05-14T09:03:02+02:00" />


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Estimating Unseen Shared Cultural Diversity"/>
<meta name="twitter:description" content="Shared Species Estimation In Demystifying Chao1 with Good-Turing, I tried to explain the intuition behind the Chao1 estimator (Chao 1984) for unseen species using the Good-Turing estimator as described in Chao et al. (2017). The latter article discusses another set of diversity measures within that same framework of Turing. The number of unique species or the number of unique cultural artifacts in a given environment is only one diversity measure, but we can also study the shared diversity between two cultural collections, for example."/>

  
  
    
  
  
  <link rel="stylesheet" href="https://www.karsdorp.io/css/styles.113434789f3c21bf5b57e90215ead36599790c0ce86e3492f239ce88648708a3dcced805b389721cf2f244af1fa951706872cadf838cb7fcc0321d7cdfa6afc8.css" integrity="sha512-ETQ0eJ88Ib9bV&#43;kCFerTZZl5DAzobjSS8jnOiGSHCKPcztgFs4lyHPLyRK8fqVFwaHLK34OMt/zAMh1836avyA=="> 

  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="https://www.karsdorp.io/images/favicon.ico" />

  
  
  
  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;" aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">Notebooks</a></li>
         
        <li><a href="/references">Publications</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" https://www.karsdorp.io/posts/20220405110456-population_size_regression_estimators/" aria-label="Previous">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="https://www.karsdorp.io/posts/20220610145347-undetected_functional_diversity/" aria-label="Next">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#" aria-label="Share">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fwww.karsdorp.io%2fposts%2f20220316142536-two_assemblage_good_turing_estimation%2f" aria-label="Facebook">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fwww.karsdorp.io%2fposts%2f20220316142536-two_assemblage_good_turing_estimation%2f&text=Estimating%20Unseen%20Shared%20Cultural%20Diversity" aria-label="Twitter">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fwww.karsdorp.io%2fposts%2f20220316142536-two_assemblage_good_turing_estimation%2f&title=Estimating%20Unseen%20Shared%20Cultural%20Diversity" aria-label="Linkedin">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fwww.karsdorp.io%2fposts%2f20220316142536-two_assemblage_good_turing_estimation%2f&is_video=false&description=Estimating%20Unseen%20Shared%20Cultural%20Diversity" aria-label="Pinterest">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Estimating%20Unseen%20Shared%20Cultural%20Diversity&body=Check out this article: https%3a%2f%2fwww.karsdorp.io%2fposts%2f20220316142536-two_assemblage_good_turing_estimation%2f" aria-label="Email">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fwww.karsdorp.io%2fposts%2f20220316142536-two_assemblage_good_turing_estimation%2f&title=Estimating%20Unseen%20Shared%20Cultural%20Diversity" aria-label="Pocket">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fwww.karsdorp.io%2fposts%2f20220316142536-two_assemblage_good_turing_estimation%2f&title=Estimating%20Unseen%20Shared%20Cultural%20Diversity" aria-label="reddit">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fwww.karsdorp.io%2fposts%2f20220316142536-two_assemblage_good_turing_estimation%2f&name=Estimating%20Unseen%20Shared%20Cultural%20Diversity&description=Shared%20Species%20Estimation%20In%20Demystifying%20Chao1%20with%20Good-Turing%2c%20I%20tried%20to%20explain%20the%20intuition%20behind%20the%20Chao1%20estimator%20%28Chao%201984%29%20for%20unseen%20species%20using%20the%20Good-Turing%20estimator%20as%20described%20in%20Chao%20et%20al.%20%282017%29.%20The%20latter%20article%20discusses%20another%20set%20of%20diversity%20measures%20within%20that%20same%20framework%20of%20Turing.%20The%20number%20of%20unique%20species%20or%20the%20number%20of%20unique%20cultural%20artifacts%20in%20a%20given%20environment%20is%20only%20one%20diversity%20measure%2c%20but%20we%20can%20also%20study%20the%20shared%20diversity%20between%20two%20cultural%20collections%2c%20for%20example." aria-label="Tumblr">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fwww.karsdorp.io%2fposts%2f20220316142536-two_assemblage_good_turing_estimation%2f&t=Estimating%20Unseen%20Shared%20Cultural%20Diversity" aria-label="Hacker News">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    
    <div id="toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#shared-species-estimation">Shared Species Estimation</a></li>
    <li><a href="#problem-description">Problem description</a></li>
    <li><a href="#mean-relative-frequencies-of-shared-items">Mean relative frequencies of shared items</a></li>
    <li><a href="#shared-richness-in-the-dutch-folktale-database">Shared Richness in the Dutch Folktale Database</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
    </div>
    
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        Estimating Unseen Shared Cultural Diversity
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2022-05-14 09:03:02 &#43;0200 CEST" itemprop="datePublished">2022-05-14</time>
          
        </div>
        
        
        <div class="article-read-time">
          <i class="far fa-clock"></i>
          
          10 minute read
        </div>
        
        
        
        <div class="article-tag">
            <i class="fas fa-tag"></i>
            
            
            <a class="tag-link" href="/tags/shared-richness" rel="tag">shared-richness</a>
            
             ,  
            <a class="tag-link" href="/tags/chao1" rel="tag">chao1</a>
            
             ,  
            <a class="tag-link" href="/tags/richness" rel="tag">richness</a>
            
             ,  
            <a class="tag-link" href="/tags/unseen-species" rel="tag">unseen-species</a>
            
             ,  
            <a class="tag-link" href="/tags/folktales" rel="tag">folktales</a>
            
        </div>
        
      </div>
    </header>

  
    
    <div class="content" itemprop="articleBody">
      <h2 id="shared-species-estimation">Shared Species Estimation</h2>
<p>In <a href="/posts/20220309103709-good_turing_as_an_unseen_species_model/">Demystifying Chao1 with Good-Turing</a>, I tried to explain the intuition behind the Chao1
estimator (<a href="#citeproc_bib_item_1">Chao 1984</a>) for unseen species using the
Good-Turing estimator as described in Chao et al. (<a href="#citeproc_bib_item_2">2017</a>). The
latter article discusses another set of diversity measures within that same framework of
Turing. The number of unique species or the number of unique cultural artifacts in a given
environment is only one diversity measure, but we can also study the shared diversity
between two cultural collections, for example. In addition to the number of unique
species, this definition of diversity thus also involves the specific composition of an
assemblage or collection. As with estimating the number of unique species, it is quite
conceivable that our samples do not give a complete picture of which species or cultural
artifacts are shared between two assemblages or collections. Fortunately, with only a few
small adjustments, we can modify the Good-Turing framework to compute a lower-bound on the
number of unseen items <em>shared</em> between two collections.</p>
<h2 id="problem-description">Problem description</h2>
<p>Imagine two collections of folk tales, collected in an attempt to map out what folk tales
people know in a particular area. The collections were established indepedently from each
other, and in each collection the observed folk tales were categorized according to the
same folk tale classification systems. The two imaginary collections consists of the
following folk tale types, that were observed with the frequencies listed in the table
below:</p>
<table>
<thead>
<tr>
<th>Story ID</th>
<th>Description</th>
<th>\(c_1\)</th>
<th>\(c_2\)</th>
</tr>
</thead>
<tbody>
<tr>
<td>SINSAG 0487</td>
<td>Precedence of other events</td>
<td>10</td>
<td>8</td>
</tr>
<tr>
<td>TM 2801</td>
<td>Strong man/woman</td>
<td>3</td>
<td>4</td>
</tr>
<tr>
<td>SINSAG 0486</td>
<td>Other signs of death</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>SINSAG 0481</td>
<td>Funeral procession seen</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td>SINSAG 0478</td>
<td>Indescribable hauntings</td>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td>SINSAG 0489</td>
<td>The second face</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>TM 3101</td>
<td>Witch makes child (human, animal) sick</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>SINSAG 1226</td>
<td>&ldquo;That&rsquo;s where he lives and this is where he is.&rdquo;</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>TM 3104</td>
<td>Devil&rsquo;s Breath as a Defense</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>SINSAG 0917</td>
<td>Devil scares sinners (cursers, wood thieves, Sunday violators or scoffers).</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>total</td>
<td></td>
<td>23</td>
<td>21</td>
</tr>
<tr>
<td>^</td>
<td></td>
<td>x</td>
<td>y</td>
</tr>
</tbody>
</table>
<p>The first collection reports a total of \(n_1 = 23\) stories, broken down into 10 unique
story types. The second collection consists of 7 story types represented by a total of
\(n_2 = 21\) folk tales. Together, the two collections consist of 10 unique folk tales,
which we denote by \(S_{\textrm{obs}}\). 7 of the 10 folk tale types appear in both
collections: \(S_{\textrm{shared}, \textrm{obs}} = 7\). Of course, these collections only
represent samples, and thus there&rsquo;s a fair chance that both collections are incomplete and
don&rsquo;t accurately describe the shared number of stories. This actual number of shared
stories and thus implicitly the number of unseen shared stories is the number we want to
calculate. We refer to the true number of shared stories with \(V_{\textrm{shared}}\). To
calculate that number, we need a number of ingredients. First, we need to know how many
stories the two collections already share (\(V_{\textrm{shared}, \textrm{obs}}\)). In
addition, we want to calculate the number of shared stories that appear only in one of the
two collections. We can denote that number with \(f_{0, +}\) for the number of stories that
do not appear in the first collection but appear at least once in the second collection.
Conversely, we use \(f_{ +, 0}\) for the number of stories that occur at least once in the
first collection but not in the second collection. Finally, we want to calculate the
number of unseen shared stories. We denote that number by \(f_{0, 0}\). Based on all these
numbers, we can calculate the true number of shared stories:</p>
<p>\[
S_{\textrm{shared}} = S_{\textrm{shared}, \textrm{obs}} + f_{0, +} + f_{ +, 0} + f_{0, 0}
\]</p>
<h2 id="mean-relative-frequencies-of-shared-items">Mean relative frequencies of shared items</h2>
<p>In <a href="/posts/20220309103709-good_turing_as_an_unseen_species_model/">Demystifying Chao1 with Good-Turing</a>, I explained how we can calculate the true average
relative frequency of species or words (or some other category) that occur \(r\) times using
the Good-Turing framework. You will need to read that post in order to understand the
following section. With minimal modifications, we can use the same strategy to calculate
the average relative frequency \(\alpha_{r+}\) of folk tales that occur \(r\) times collection
1 and at least once (hence the &lsquo;+&rsquo; sign) in collection 2. The formula looks like this:</p>
<p>\[
\alpha_{r+} = \frac{(r + 1)f_{r+1, +}}{(n_1 - r)f_{r, +}}
\]</p>
<p>Of course, we can also compute the average relative frequency \(\alpha_{+, v}\) of folk
tales occurring \(v\) times in collection 2 and at least once in collection 1:</p>
<p>\[
\alpha_{+, v} = \frac{(v + 1)f_{ +, v+1}}{(n_2 - r)f_{ +, v}}
\]</p>
<p>If a folk type occurs equally often in both collections, we can calculate the average
relative frequency \(\alpha_{rr}\) with:</p>
<p>\[
\alpha_{rr} = \frac{(r + 1)^2 f_{r+1, r+1}}{(n_1 - r) (n_2 - r)f_{r, r}}
\]</p>
<p>Back to the calculation of \(v_{\textrm{shared}}\). Just as we have seen in <a href="/posts/20220309103709-good_turing_as_an_unseen_species_model/">Demystifying
Chao1 with Good-Turing</a>, we cannot compute \(f_{0, +}\) and \(f_{ +, 0}\) directly, since we
have no knowledge about \(\alpha_{0,q +}\) en \(\alpha_{ +, 0}\). In other words, we don&rsquo;t know
the frequency with which shared folk tales occur in one of the collections but not in the
other. What we do know, however, is that \(\frac{\alpha_{0, +} f_{0, +}}{\alpha_{0, +}}
\geq \frac{\alpha_{0, +} f_{0, +}}{\alpha_{1, +}}\). And that last term can be calculated
with:</p>
<p>\[
f_{0, +} = \frac{\alpha_{0, +} f_{0,
+}}{\alpha_{0, +}} \geq \frac{\alpha_{0, +} f_{0, +}}{\alpha_{1, +}} = \frac{\frac{f_{1, +}}{n_1}}{\frac{2f_{2, +}}{(n_1 - 1)f_{1, +}}} = \frac{(n_1 - 1)}{n_1} \frac{f^2_{1, +}}{2f_{2, +}}
\]</p>
<p>Conversely, the frequency with which shared folk tales occur in collection 1 but not in
collection 2 (\(f_{+, 0}\)) can be calculated with:</p>
<p>\[
f_{+, 0} = \frac{\alpha_{ +, 0} f_{ +,
0}}{\alpha_{ +, 0}} \geq \frac{\alpha_{ +, 0} f_{ +, 0}}{\alpha_{ +, 1}} = \frac{\frac{f_{ +, 1}}{n_2}}{\frac{2f_{ +, 2}}{(n_2 - 1)f_{ +, 1}}} = \frac{(n_2 - 1)}{n_2} \frac{f^2_{ +, 1}}{2f_{ +, 2}}
\]</p>
<p>All that remains is computing \(f_{0, 0}\), for which we may also assume that \(\alpha_{0, 0}
\leq \alpha_{1, 1}\). That leads to:</p>
<p>\[
f_{0, 0} = \frac{\alpha_{0, 0} f_{0, 0}}{\alpha_{0, 0}} \geq \frac{\alpha_{0, 0} f_{0, 0}}{\alpha_{1, 1}} = \frac{\frac{f_{1, 1}}{n_1, n_2}}{\frac{4f_{2, 2}}{(n_1 - 1) (n_2 - 1)f_{1, 1}}} = \frac{(n_1 - 1)}{n_1} \frac{(n_2 - 1)}{n_2} \frac{f^2_{1, 1}}{4f_{2, 2}}
\]</p>
<p>We apply these formulas to our invented story collections to calculate the actual shared
repertoire. For \(f_{0, + }\), we have \(\frac{(n_1 - 1)}{n_1} \frac{f^2_{1, +}}{2f_{2, +}} =
\frac{22}{23} \frac{3^2}{4} = 2.2\). And for \(f_{ +, 0}\), we have that \(\frac{(n_2 -
1)}{n_2} \frac{f^2_{ +, 1}}{2f_{ +, 2}} = \frac{20}{21} \frac{2^2}{4} = 1.4\). To compute
\(f_{0, 0}\), then, we compute \(\frac{(n_1 - 1)}{n_1} \frac{(n_2 - 1)}{n_2} \frac{f^2_{1,
1}}{4f_{2, 2}} = \frac{22}{23} \frac{20}{21} \frac{1^2}{4} = 0.2\). Finally we compute
\(S_{\text{shared}}\):</p>
<p>\[
S_{\textrm{shared}} = 7 + 2.2 + 1.4 + 0.2 = 11
\]</p>
<h2 id="shared-richness-in-the-dutch-folktale-database">Shared Richness in the Dutch Folktale Database</h2>
<p>Having applied Chao&rsquo;s shared richness estimator to a toy example, it would be interesting
to apply it to a real case. Below, I apply the estimator to the <a href="https://www.verhalenbank.nl">Dutch Folktale Database</a>, a
tremendous resource hosting over 45,000 folktales in Dutch and Dutch dialects. All the
stories in the database are annotated in great detail, with information on such things as
origin, time, speaker, motifs, keywords and much more (see <a href="#citeproc_bib_item_3">Meder et al. 2016</a> for a complete overview). In addition, most of
the stories are categorized according to established classification systems for folktales,
such as for example, the Aarne-Thompson-Uther (ATU) classification system. These
categories, or, story types, can be understood as the equivalent of species names in
biology. As such, we can make use of Unseen Species models to estimate the true story
richness (in a particular region, time, or collection).</p>
<p>In what follows, I would like to calculate the shared story richness based on the shared
richness estimator of Chao et al. (<a href="#citeproc_bib_item_2">2017</a>) described above. For
this purpose I use a subcorpus of the database, consisting of stories collected by Dam
Jaarsma. Folktale collector Jaarsma collected an enormous amount of stories (over 15,000)
in the Dutch province of Frysia and in particular in the eastern region called &ldquo;de Friese
Wouden&rdquo;. Jaarsma recorded most of stories in two places: Drachten (\(n_1=1065\)) and Harkema
(\(n_2=1448\)). In total, \(S_{\text{obs}}=407\) different story types were found in these two
places, of which \(S_{\text{shared, obs}}=136\). were found in both places. Of course, both
subsets are samples from a likely larger population, and as such, there is a significant
chance that the two places shared more (knowledge about) stories than is apparent from the
recordings of Jaarsma. Below, I try to use the method described in
Chao et al. (<a href="#citeproc_bib_item_2">2017</a>) to provide a lower bound on the true number
of shared stories.</p>
<p>In order to simplify the data processing, I have put all the stories recorded by Dam
Jaarsma in Drachten and Harkema in a conveniently arranged table, containing on each row a
unique story type, and the number of attestations of each type in both places:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#007020;font-weight:bold">import</span> <span style="color:#0e84b5;font-weight:bold">pandas</span> <span style="color:#007020;font-weight:bold">as</span> <span style="color:#0e84b5;font-weight:bold">pd</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df <span style="color:#666">=</span> pd<span style="color:#666">.</span>read_csv(<span style="color:#4070a0">&#34;data/dfd-jaarsma.csv&#34;</span>)
</span></span><span style="display:flex;"><span>df<span style="color:#666">.</span>head()
</span></span></code></pre></div><table>
<thead>
<tr>
<th></th>
<th>drachten</th>
<th>harkema</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>65</td>
<td>123</td>
</tr>
<tr>
<td>1</td>
<td>56</td>
<td>84</td>
</tr>
<tr>
<td>2</td>
<td>42</td>
<td>39</td>
</tr>
<tr>
<td>3</td>
<td>38</td>
<td>56</td>
</tr>
<tr>
<td>4</td>
<td>33</td>
<td>45</td>
</tr>
</tbody>
</table>
<p>Using vectorized operations, it is relatively straightforward to implement the Shared
Richness Estimator. The function definition <code>estimate_shared_richness</code> below takes two
NumPy arrays or Pandas Series as input representing the counts of each uniquely found
species or story type. It then computes the estimated shared richness, as well as all
other statistics supporting this number:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#007020;font-weight:bold">def</span> <span style="color:#06287e">estimate_shared_richness</span>(s1, s2):
</span></span><span style="display:flex;"><span>    n1, n2 <span style="color:#666">=</span> s1<span style="color:#666">.</span>sum(), s2<span style="color:#666">.</span>sum()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#60a0b0;font-style:italic"># Compute f_{0, +}</span>
</span></span><span style="display:flex;"><span>    f1p <span style="color:#666">=</span> ((s1 <span style="color:#666">==</span> <span style="color:#40a070">1</span>) <span style="color:#666">&amp;</span> (s2 <span style="color:#666">&gt;=</span> <span style="color:#40a070">1</span>))<span style="color:#666">.</span>sum()
</span></span><span style="display:flex;"><span>    f2p <span style="color:#666">=</span> ((s1 <span style="color:#666">==</span> <span style="color:#40a070">2</span>) <span style="color:#666">&amp;</span> (s2 <span style="color:#666">&gt;=</span> <span style="color:#40a070">1</span>))<span style="color:#666">.</span>sum()
</span></span><span style="display:flex;"><span>    f0p <span style="color:#666">=</span> ((n1 <span style="color:#666">-</span> <span style="color:#40a070">1</span>) <span style="color:#666">/</span> n1) <span style="color:#666">*</span> ((f1p <span style="color:#666">**</span> <span style="color:#40a070">2</span>) <span style="color:#666">/</span> (<span style="color:#40a070">2</span> <span style="color:#666">*</span> f2p))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#60a0b0;font-style:italic"># Compute f_{+, 0}</span>
</span></span><span style="display:flex;"><span>    fp1 <span style="color:#666">=</span> ((s1 <span style="color:#666">&gt;=</span> <span style="color:#40a070">1</span>) <span style="color:#666">&amp;</span> (s2 <span style="color:#666">==</span> <span style="color:#40a070">1</span>))<span style="color:#666">.</span>sum()
</span></span><span style="display:flex;"><span>    fp2 <span style="color:#666">=</span> ((s1 <span style="color:#666">&gt;=</span> <span style="color:#40a070">1</span>) <span style="color:#666">&amp;</span> (s2 <span style="color:#666">==</span> <span style="color:#40a070">2</span>))<span style="color:#666">.</span>sum()
</span></span><span style="display:flex;"><span>    fp0 <span style="color:#666">=</span> ((n2 <span style="color:#666">-</span> <span style="color:#40a070">1</span>) <span style="color:#666">/</span> n2) <span style="color:#666">*</span> ((fp1 <span style="color:#666">**</span> <span style="color:#40a070">2</span>) <span style="color:#666">/</span> (<span style="color:#40a070">2</span> <span style="color:#666">*</span> fp2))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#60a0b0;font-style:italic"># Compute f_{0, 0}</span>
</span></span><span style="display:flex;"><span>    f11 <span style="color:#666">=</span> ((s1 <span style="color:#666">==</span> <span style="color:#40a070">1</span>) <span style="color:#666">&amp;</span> (s2 <span style="color:#666">==</span> <span style="color:#40a070">1</span>))<span style="color:#666">.</span>sum()
</span></span><span style="display:flex;"><span>    f22 <span style="color:#666">=</span> ((s1 <span style="color:#666">==</span> <span style="color:#40a070">2</span>) <span style="color:#666">&amp;</span> (s2 <span style="color:#666">==</span> <span style="color:#40a070">2</span>))<span style="color:#666">.</span>sum()
</span></span><span style="display:flex;"><span>    f00 <span style="color:#666">=</span> ((n1 <span style="color:#666">-</span> <span style="color:#40a070">1</span>) <span style="color:#666">/</span> n1) <span style="color:#666">*</span> ((n2 <span style="color:#666">-</span> <span style="color:#40a070">1</span>) <span style="color:#666">/</span> n2) <span style="color:#666">*</span> ((f11 <span style="color:#666">**</span> <span style="color:#40a070">2</span>) <span style="color:#666">/</span> (<span style="color:#40a070">4</span> <span style="color:#666">*</span> f22))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    obs_shared <span style="color:#666">=</span> ((s1 <span style="color:#666">&gt;</span> <span style="color:#40a070">0</span>) <span style="color:#666">&amp;</span> (s2 <span style="color:#666">&gt;</span> <span style="color:#40a070">0</span>))<span style="color:#666">.</span>sum()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    S <span style="color:#666">=</span> obs_shared <span style="color:#666">+</span> f0p <span style="color:#666">+</span> fp0 <span style="color:#666">+</span> f00
</span></span><span style="display:flex;"><span>    <span style="color:#007020;font-weight:bold">return</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#4070a0">&#34;S&#34;</span>: <span style="color:#007020">round</span>(S),
</span></span><span style="display:flex;"><span>        <span style="color:#4070a0">&#34;observed shared&#34;</span>: obs_shared,
</span></span><span style="display:flex;"><span>        <span style="color:#4070a0">&#34;f0+&#34;</span>: <span style="color:#007020">round</span>(f0p),
</span></span><span style="display:flex;"><span>        <span style="color:#4070a0">&#34;f+0&#34;</span>: <span style="color:#007020">round</span>(fp0),
</span></span><span style="display:flex;"><span>        <span style="color:#4070a0">&#34;f00&#34;</span>: <span style="color:#007020">round</span>(f00)
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>We apply the function to our data to compute a lower-bound of the true number of shared
story types between Drachten and Harkema:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>est <span style="color:#666">=</span> estimate_shared_richness(df[<span style="color:#4070a0">&#34;harkema&#34;</span>], df[<span style="color:#4070a0">&#34;drachten&#34;</span>])
</span></span><span style="display:flex;"><span><span style="color:#007020">print</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#4070a0">f</span><span style="color:#4070a0">&#34;Observed nunber of shared story types: </span><span style="color:#70a0d0;font-style:italic">{</span>est[<span style="color:#4070a0">&#39;observed shared&#39;</span>]<span style="color:#70a0d0;font-style:italic">}</span><span style="color:#4070a0;font-weight:bold">\n</span><span style="color:#4070a0">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#4070a0">f</span><span style="color:#4070a0">&#34;Estimated # shared story types: </span><span style="color:#70a0d0;font-style:italic">{</span>est[<span style="color:#4070a0">&#39;S&#39;</span>]<span style="color:#70a0d0;font-style:italic">}</span><span style="color:#4070a0;font-weight:bold">\n</span><span style="color:#4070a0">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#4070a0">f</span><span style="color:#4070a0">&#34;Estimated # stories present but unseen in Harkema and present in Drachten: </span><span style="color:#70a0d0;font-style:italic">{</span>est[<span style="color:#4070a0">&#39;f0+&#39;</span>]<span style="color:#70a0d0;font-style:italic">}</span><span style="color:#4070a0;font-weight:bold">\n</span><span style="color:#4070a0">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#4070a0">f</span><span style="color:#4070a0">&#34;Estimated # stories present in Harkema but unseen yet present in Drachten: </span><span style="color:#70a0d0;font-style:italic">{</span>est[<span style="color:#4070a0">&#39;f+0&#39;</span>]<span style="color:#70a0d0;font-style:italic">}</span><span style="color:#4070a0;font-weight:bold">\n</span><span style="color:#4070a0">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#4070a0">f</span><span style="color:#4070a0">&#34;Estimated # stories unseen yet present in both Harkema and Drachten: </span><span style="color:#70a0d0;font-style:italic">{</span>est[<span style="color:#4070a0">&#39;f00&#39;</span>]<span style="color:#70a0d0;font-style:italic">}</span><span style="color:#4070a0">&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Observed nunber of shared story types: 136
</span></span><span style="display:flex;"><span>Estimated # shared story types: 244
</span></span><span style="display:flex;"><span>Estimated # stories present but unseen in Harkema and present in Drachten: 48
</span></span><span style="display:flex;"><span>Estimated # stories present in Harkema but unseen yet present in Drachten: 26
</span></span><span style="display:flex;"><span>Estimated # stories unseen yet present in both Harkema and Drachten: 34
</span></span></code></pre></div><p>The collections of Jaarsma report a total of 136 story types present in both Drachten and
Harkema. Being a sample of the true population, this number is likely biased. The Shared
Richness estimator developed in Chao et al. (<a href="#citeproc_bib_item_2">2017</a>) corrects
this bias to a lower-bound of at least 244 story types shared between the two places.
Thus, at least \(244 - 136 = 108\) story types were likely present in both places even though
it was not recorded by Jaarsma. 48 of these story types were already seen in Drachten, but
not yet in Harkema, and 26 of them have been observed by Jaarsma in Harkema but not in
Drachten. Finally, a total of 34 story types were shared between both places, but neither
of them has a record of these types.</p>
<p>While this application to two folktale collections obviouslyy has only a limited scope, I
hope that it nevertheless does a good job of illustrating how the Shared Richness
estimator can help to estimate similarities and differences in cultural diversity. Due to
undersampling, biases can emerge in our perception of (shared) diversity. The Shared
richness estimator allows us to correct this bias and turn the observed shared richness
into a lower-bound of the true share diversity. Such a correction is of crucial importance
when we want to map out the cultural similarities and diferences between cultures in past
and present.</p>
<h2 id="references">References</h2>
<style>.csl-entry{text-indent: -1.5em; margin-left: 1.5em;}</style><div class="csl-bib-body">
  <div class="csl-entry"><a id="citeproc_bib_item_1"></a>Chao, Anne. 1984. “Nonparametric Estimation of the Number of Classes in a Population.” <i>Scandinavian Journal of Statistics</i> 11 (4): 265–70.</div>
  <div class="csl-entry"><a id="citeproc_bib_item_2"></a>Chao, Anne, Chiu Chun‐Huo, Robert K. Colwell, Luiz Fernando S. Magnago, Robin L. Chazdon, and Nicholas J. Gotelli. 2017. “Deciphering the Enigma of Undetected Species, Phylogenetic, and Functional Diversity Based on Good‐Turing Theory.” <i>Ecology</i> 98 (11): 2914–29. <a href="https://doi.org/10.1002/ecy.2000">https://doi.org/10.1002/ecy.2000</a>.</div>
  <div class="csl-entry"><a id="citeproc_bib_item_3"></a>Meder, Theo, Folgert Karsdorp, Dong Nguyen, Mariët Theune, Dolf Trieschnigg, and Iwe Muiser. 2016. “Automatic Enrichment and Classification of Folktales in the Dutch Folktale Database.” <i>Journal of American Folklore</i> 129 (511): 78–96.</div>
</div>
    </div>
  </article>

  
  






  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/posts">Notebooks</a></li>
         
          <li><a href="/references">Publications</a></li>
        
      </ul>
    </div>

    
    <div id="toc-footer" style="display: none">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#shared-species-estimation">Shared Species Estimation</a></li>
    <li><a href="#problem-description">Problem description</a></li>
    <li><a href="#mean-relative-frequencies-of-shared-items">Mean relative frequencies of shared items</a></li>
    <li><a href="#shared-richness-in-the-dutch-folktale-database">Shared Richness in the Dutch Folktale Database</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
    </div>
    

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fwww.karsdorp.io%2fposts%2f20220316142536-two_assemblage_good_turing_estimation%2f" aria-label="Facebook">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fwww.karsdorp.io%2fposts%2f20220316142536-two_assemblage_good_turing_estimation%2f&text=Estimating%20Unseen%20Shared%20Cultural%20Diversity" aria-label="Twitter">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fwww.karsdorp.io%2fposts%2f20220316142536-two_assemblage_good_turing_estimation%2f&title=Estimating%20Unseen%20Shared%20Cultural%20Diversity" aria-label="Linkedin">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fwww.karsdorp.io%2fposts%2f20220316142536-two_assemblage_good_turing_estimation%2f&is_video=false&description=Estimating%20Unseen%20Shared%20Cultural%20Diversity" aria-label="Pinterest">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Estimating%20Unseen%20Shared%20Cultural%20Diversity&body=Check out this article: https%3a%2f%2fwww.karsdorp.io%2fposts%2f20220316142536-two_assemblage_good_turing_estimation%2f" aria-label="Email">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fwww.karsdorp.io%2fposts%2f20220316142536-two_assemblage_good_turing_estimation%2f&title=Estimating%20Unseen%20Shared%20Cultural%20Diversity" aria-label="Pocket">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fwww.karsdorp.io%2fposts%2f20220316142536-two_assemblage_good_turing_estimation%2f&title=Estimating%20Unseen%20Shared%20Cultural%20Diversity" aria-label="reddit">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fwww.karsdorp.io%2fposts%2f20220316142536-two_assemblage_good_turing_estimation%2f&name=Estimating%20Unseen%20Shared%20Cultural%20Diversity&description=Shared%20Species%20Estimation%20In%20Demystifying%20Chao1%20with%20Good-Turing%2c%20I%20tried%20to%20explain%20the%20intuition%20behind%20the%20Chao1%20estimator%20%28Chao%201984%29%20for%20unseen%20species%20using%20the%20Good-Turing%20estimator%20as%20described%20in%20Chao%20et%20al.%20%282017%29.%20The%20latter%20article%20discusses%20another%20set%20of%20diversity%20measures%20within%20that%20same%20framework%20of%20Turing.%20The%20number%20of%20unique%20species%20or%20the%20number%20of%20unique%20cultural%20artifacts%20in%20a%20given%20environment%20is%20only%20one%20diversity%20measure%2c%20but%20we%20can%20also%20study%20the%20shared%20diversity%20between%20two%20cultural%20collections%2c%20for%20example." aria-label="Tumblr">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fwww.karsdorp.io%2fposts%2f20220316142536-two_assemblage_good_turing_estimation%2f&t=Estimating%20Unseen%20Shared%20Cultural%20Diversity" aria-label="Hacker News">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu-toggle" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;" aria-label="Menu">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
        <a id="toc-toggle" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;" aria-label="TOC">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share-toggle" class="icon" href="#" onclick="$('#share-footer').toggle();return false;" aria-label="Share">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2022  Folgert Karsdorp; made with Hugo and Org-mode 
  </div>
  <div class="footer-right">
    
    
    
    
    
    
    
    
    
    
    
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>

<script src=/js/code-copy.js></script>



  


<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']]
    },
    svg: {
      fontCache: 'global'
    }
  };
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>

</html>
